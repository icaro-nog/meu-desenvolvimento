!function(r,l){var d=r(document),u={};l.bind("ready",function(e,t){function c(i,e,o,s){var a,n;"yes"!==Customify_Layout_Builder.hide_switcher&&"object"==typeof i.versions&&(a="",r.each(i.versions,function(e,t){a+='<option value="'+e+'" '+(e===s?' selected="selected" ':"")+">"+t.label+"</option>"}),a&&(n=r('<span class="customify-swicth-version button-primary"><span>'+Customify_Layout_Builder.swicth_version+'</span><select class="builder-version-change ">'+a+"</select></span>"),r(".customify--cb-actions",e.container).prepend(n)),n.on("change","select",function(){var e,t=r(this).val();u[o+s]&&u[o+s].container.hide(),void 0===u[o+t]&&(e=new("v2"===t?CustomizeBuilder_V2:CustomizeBuilder_V1)(i,o),c(i,e,o,t),u[o+t]=e),l.control(i.version_id).setting.set(t),d.trigger("customify/customizer/value_changed"),u[o+t]&&u[o+t].container.show(),n.find("option").removeAttr("selected"),n.find('option[value="'+s+'"]').attr("selected","selected")}))}_.each(Customify_Layout_Builder.builders,function(e,t){var i,o="v1";void 0!==e.version_id?o=l.control(e.version_id).params.value:e.version_id=!1,i=new("v2"===o?CustomizeBuilder_V2:CustomizeBuilder_V1)(e,t),u[t+o]=i,c(e,i,t,o)}),l.bind("pane-contents-reflowed",function(){setTimeout(function(){r("#sub-accordion-panel-widgets .no-widget-areas-rendered-notice .footer_moved_widgets_text").length||r("#sub-accordion-panel-widgets .no-widget-areas-rendered-notice").append('<p class="footer_moved_widgets_text">'+Customify_Layout_Builder.footer_moved_widgets_text+"</p>")},1e3)}),l.state("expandedSection").bind(function(e){r(".customify--device-panel .grid-stack-item").removeClass("item-active"),r(".customify--cb-row").removeClass("row-active"),e&&(r('.customify--cb-row[data-id="'+e.id+'"]').addClass("row-active"),r(".customify--device-panel .grid-stack-item.for-s-"+e.id).addClass("item-active"))})}),d.on("click",".focus-section",function(e){e.preventDefault();e=r(this).attr("data-id")||"";(e=e||(e=r(this).attr("href")||"").replace("#",""))&&l.section(e)&&l.section(e).focus()}),d.on("click",".focus-control",function(e){e.preventDefault();e=r(this).attr("data-id")||"";(e=e||(e=r(this).attr("href")||"").replace("#",""))&&l.control(e)&&l.control(e).focus()}),d.on("click",".focus-panel",function(e){e.preventDefault();e=r(this).attr("data-id")||"";(e=e||(e=r(this).attr("href")||"").replace("#",""))&&l.panel(e)&&l.panel(e).focus()}),d.on("click",".save-template-form .save-builder-template",function(e){e.preventDefault();var t=r(this).closest(".customize-control"),i=r(".template-input-name",t),e=i.val();e&&""!==e&&r.post(ajaxurl,{action:"customify_builder_save_template",name:i.val(),id:i.attr("data-builder-id")||"",control:i.attr("data-control-id")||"",preview_data:l.get()},function(e){e.success&&(i.val(""),t.find(".list-saved-templates").prepend(e.data.li),t.find(".list-saved-templates").addClass("has-templates"))})}),d.on("click",".list-saved-templates .saved_template .remove-tpl",function(e){e.preventDefault();var t=r(this).parent(),i=r(this).closest(".customize-control"),e=r(".template-input-name",i),o=t.data("id")||"";r.post(ajaxurl,{action:"customify_builder_save_template",id:e.attr("data-builder-id")||"",remove:o},function(e){t.remove(),i.find(".list-saved-templates li.saved_template").length<=0&&i.find(".list-saved-templates").removeClass("has-templates")})});d.on("click",".list-saved-templates .saved_template .load-tpl",function(e){e.preventDefault();var e=r(this).parent(),t=r.Deferred(),i=_.clone(window.location),o=e.data("control-id")||"",e=e.data("data")||{},s=(_.isObject(e)||(e={}),_.each(e,function(e,t){l.control(t)&&!_.isEmpty(e)&&l.control(t).setting.set(encodeURI(JSON.stringify(e)))}),r(".wp-full-overlay")),a=(s.addClass("customize-active full-overlay-active customize-loading"),function(){var e;if(!(0<l.state("processing").get()))return l.state("processing").unbind(a),(e=l.requestChangesetUpdate()).done(function(){r(window).off("beforeunload.customize-confirm"),top.location.href=i.origin+i.pathname+"?autofocus[control]="+o+"&url="+encodeURIComponent(l.previewer.previewUrl.get())+"&changeset_uuid="+l.settings.changeset.uuid,t.resolve()}),e.fail(function(){s.removeClass("customize-loading"),t.reject()}),t.promise()});0===l.state("processing").get()?a():l.state("processing").bind(a)}),d.on("mouseover",".customify--cb-row .grid-stack-item:not(.no-tooltip)",function(e){var t=r(this),i=r(".customify--cb-item-remove",t).outerWidth()+r(".customify--cb-item-setting",t).outerWidth();r(".grid-stack-item-content",t).innerWidth()-50<i&&t.addClass("show-tooltip")}),d.on("mouseleave",".customify--cb-row .grid-stack-item:not(.no-tooltip)",function(e){r(this).removeClass("show-tooltip")})}(jQuery,wp.customize||null);